<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Thanh toán | FashionShop</title>

  <link rel="stylesheet" href="../css/site.css">
  <link rel="stylesheet" href="../css/checkout.css">
</head>
<body class="page-checkout">

<header class="site-header">
  <div class="container header-inner">
    <a class="brand" href="./index.html">Fashion<span>Shop</span></a>

    <nav class="main-nav" aria-label="Chính">
      <a href="./index.html">Trang chủ</a>

      <!-- Dropdown Danh mục -->
      <div class="nav-dd">
        <button class="dd-trigger" type="button" aria-haspopup="true" aria-expanded="false">
          Danh mục ▾
        </button>
        <ul class="dd-menu" role="menu" aria-label="Danh mục">
          <li><a role="menuitem" href="./user-category.html?category=Trang%20phục%20Xuân%20Hè">Trang phục Xuân Hè</a></li>
          <li><a role="menuitem" href="./user-category.html?category=Trang%20phục%20Thu%20Đông">Trang phục Thu Đông</a></li>
          <li><a role="menuitem" href="./user-category.html?category=Giày%20dép">Giày dép</a></li>
          <li><a role="menuitem" href="./user-category.html?category=Phụ%20kiện">Phụ kiện</a></li>
        </ul>
      </div>

      <a href="./user-category.html" class="all-products-link">Tất cả sản phẩm</a>
      <a href="./user-orders.html" class="orders-link">Đơn hàng</a>
      <button type="button" class="icon-btn" id="openSearch">Tìm kiếm</button>
      <a href="./cart.html">Giỏ hàng</a>
    </nav>

    <!-- Khu tài khoản (giống user-category) -->
    <a href="./login.html" class="actions account-login" id="accEntry">
      <span class="avatar anon" aria-hidden="true"></span>
      <span class="account-text">Đăng nhập</span>
    </a>
  </div>
</header>


  <section class="hero">
    <div class="container">
      <nav class="breadcrumbs" aria-label="Vị trí">
        <a href="./index.html">Trang chủ</a>
        <span>Thanh toán</span>
      </nav>
      <h1>Thanh toán</h1>
    </div>
  </section>

  <main class="container ck-grid">
  <!-- LEFT: mô phỏng danh sách sản phẩm -->
  <section class="ck-left">
    <h2 class="ck-sec-title">Sản phẩm của bạn</h2>
    <div id="ckProdList" class="ck-prodlist">
      <!-- JS sẽ render mô phỏng ở đây -->
    </div>
  </section>

  <!-- RIGHT: thẻ nhỏ Địa chỉ + Thanh toán -->
  <aside class="ck-right">
    <div class="ck-box">
      <div class="ck-box-head">
        <h3>Địa chỉ nhận hàng</h3>
        <button id="editAddrBtn" type="button" class="btn-ghost sm">Chỉnh sửa</button>
      </div>
      <div class="addr-card" id="addrCard">
        <div class="addr-line name"   id="addrName">—</div>
        <div class="addr-line phone"  id="addrPhone">—</div>
        <div class="addr-line email"  id="addrEmail">—</div>
        <div class="addr-line street" id="addrStreet">—</div>
      </div>
    </div>

    <div class="ck-box">
      <div class="ck-box-head">
        <h3>Phương thức thanh toán</h3>
      </div>

      <!-- Segmented buttons -->
      <div id="paySeg" class="pay-seg" role="group" aria-label="Chọn phương thức thanh toán">
        <button type="button" class="seg active" data-value="cod"   aria-pressed="true">Tiền mặt</button>
        <button type="button" class="seg"        data-value="bank"  aria-pressed="false">Chuyển khoản</button>
        <button type="button" class="seg"        data-value="online" aria-pressed="false">Trực tuyến</button>
      </div>
      <input type="hidden" id="payMethod" value="cod">
    </div>

    <button id="placeOrder" class="btn btn-primary full">Đặt hàng</button>
  </aside>
</main>

<!-- Modal: Đặt hàng thành công -->
<div id="ckDone" class="ck-modal" aria-hidden="true">
  <div class="ck-modal-card">
    <h3>Đặt hàng thành công!</h3>
    <p>Chúng tôi đã ghi nhận đơn của bạn.</p>
    <div class="ck-modal-actions">
        <a href="./user-orders.html" class="btn btn-primary">Xem đơn hàng</a>
        <a href="./index.html" class="btn btn-ghost btn">Trang chủ</a>
    </div>
  </div>
</div>

<!-- Modal: Chỉnh sửa địa chỉ -->
<div id="addrEditModal" class="ck-modal" aria-hidden="true">
  <div class="ck-modal-card">
    <h3>Địa chỉ nhận hàng</h3>

<!-- Nút chuyển chế độ địa chỉ -->
<div id="addrSeg" class="addr-seg">
  <button type="button" class="seg active" data-mode="account" aria-pressed="true">Địa chỉ hiện tại</button>
  <button type="button" class="seg" data-mode="new" aria-pressed="false">Địa chỉ mới</button>
</div>


    <!-- Khối địa chỉ từ tài khoản (cho phép chỉnh nhẹ nếu muốn) -->
    <form id="accAddrForm" class="addr-form">
      <div class="row2">
        <div class="form-row">
          <label>Họ và tên</label>
          <input id="acc_fullName_inp" type="text" />
        </div>
        <div class="form-row">
          <label>Số điện thoại</label>
          <input id="acc_phone_inp" type="tel" />
        </div>
      </div>
      <div class="form-row">
        <label>Email</label>
        <input id="acc_email_inp" type="email" />
      </div>
      <div class="form-row">
        <label>Địa chỉ</label>
        <input id="acc_address_inp" type="text" placeholder="Số nhà, đường, phường/xã, quận/huyện, tỉnh/thành" />
      </div>
    </form>

    <!-- Khối địa chỉ mới -->
    <form id="newAddrForm" class="addr-form" style="display:none;">
      <div class="row2">
        <div class="form-row">
          <label>Họ và tên</label>
          <input id="new_fullName_inp" type="text" placeholder="Nguyễn Văn A" />
        </div>
        <div class="form-row">
          <label>Số điện thoại</label>
          <input id="new_phone_inp" type="tel" placeholder="09xxxxxxxx" />
        </div>
      </div>
      <div class="form-row">
        <label>Email</label>
        <input id="new_email_inp" type="email" placeholder="you@example.com" />
      </div>
      <div class="form-row">
        <label>Tỉnh/Thành</label>
        <input id="new_province_inp" type="text" placeholder="VD: TP. Hồ Chí Minh" />
      </div>
      <div class="row2">
        <div class="form-row">
          <label>Quận/Huyện</label>
          <input id="new_district_inp" type="text" placeholder="VD: Quận 1" />
        </div>
        <div class="form-row">
          <label>Phường/Xã</label>
          <input id="new_ward_inp" type="text" placeholder="VD: Phường Bến Nghé" />
        </div>
      </div>
      <div class="form-row">
        <label>Địa chỉ chi tiết</label>
        <input id="new_address_inp" type="text" placeholder="Số nhà, tên đường" />
      </div>
    </form>

    <div class="ck-modal-actions">
      <button id="addrCancelBtn" type="button" class="btn btn-ghost">Hủy</button>
      <button id="addrSaveBtn" type="button" class="btn btn-primary">Lưu địa chỉ</button>
    </div>
  </div>
</div>

    <footer class="site-footer"><div class="container">© 2025 FashionShop</div></footer>

  <!-- DỮ LIỆU SẢN PHẨM NHÚNG TRỰC TIẾP (thay cho fetch products.json) -->
  <script id="products-data" type="application/json">
  [
    { 
      "id": 1, 
      "name": "Đầm Nữ Sơ Mi Cotton Tay Ngắn Rút Dây Regular", 
      "category": "Trang phục Xuân Hè", 
      "price": 590000, 
      "img": "../assets/products/1.webp",
      "sizes": ["S","M","L","XL"], 
      "description": [
        "Chất liệu cotton thoáng mát, phom A-line tôn dáng. Phù hợp đi làm, dạo phố.",
        "Chất liệu: Cotton 100%",
        "Xuất xứ: Việt Nam",
        "Giặt máy chế độ nhẹ, không tẩy."
      ],
      "images": [
        "../assets/products/1.webp",
        "../assets/products/1.1.webp",
        "../assets/products/1.2.webp",
        "../assets/products/1.3.webp"
      ]
    },
    { 
      "id": 2, 
      "name": "Áo tanktop Slimme.Fitted", 
      "category": "Trang phục Xuân Hè", 
      "price": 160200, 
      "img": "../assets/products/2.webp" 
    },
    { 
      "id": 4, 
      "name": "Quần Denim Nữ Xanh Navy Rã Phối Form Balloon", 
      "category": "Trang phục Xuân Hè", 
      "price": 633000, 
      "img": "../assets/products/3.webp" 
    },
    { 
      "id": 3, 
      "name": "Áo Thun Tanktop Nam Sát Nách Cotton Form Loose", 
      "category": "Trang phục Xuân Hè", 
      "price": 373000, 
      "img": "../assets/products/4.webp" 
    },
    { 
      "id": 5, 
      "name": "Áo Thun Nam Tay Ngắn Thêu Chữ Trước Ngực Fitted", 
      "category": "Trang phục Xuân Hè", 
      "price": 343000, 
      "img": "../assets/products/5.webp" 
    },
    { 
      "id": 6, 
      "name": "Quần Short Nam Cotton Lưng Thun In Chữ Form Relax", 
      "category": "Trang phục Xuân Hè", 
      "price": 392000, 
      "img": "../assets/products/6.webp" 
    },
    { 
      "id": 7, 
      "name": "BE BOLD DERBY", 
      "category": "Giày dép", 
      "price": 2350000, 
      "img": "../assets/products/7.webp",
      "sizes": ["38","39","40","41","42","43","44","45"], 
      "description": [
        "Đại diện cho sự thoải mái và phóng khoáng, Be Bold Derby là ứng cử viên sáng giá cho các quý ông đang tìm kiếm một đôi giày có thể dễ dàng kết hợp với nhiều loại trang phục. Với sự kỳ công và tỉ mỉ trong thiết kế lẫn chất liệu, Fashion shop tin chắc rằng đôi giày Derby này sẽ giúp các quý ông nâng tầm phong cách cá nhân, đồng thời thể hiện cái tôi của bản thân."
      ],
      "images": [
        "../assets/products/7.webp",
        "../assets/products/7.1.webp",
        "../assets/products/7.2.webp",
        "../assets/products/7.3.webp"
      ]
    }, 
    { 
      "id": 8, 
      "name": "Giày Sandal Nữ MWC E196", 
      "category": "Giày dép", 
      "price": 195000, 
      "img": "../assets/products/8.jpg" 
    },
    { 
      "id": 9, 
      "name": "Giày Cao Gót MWC G266", 
      "category": "Giày dép", 
      "price": 235000, 
      "img": "../assets/products/9.jpg" 
    },
    { 
      "id": 10, 
      "name": "Giày Cao Gót Kiểu Dáng Basic Bít Mũi Bít Gót", 
      "category": "Giày dép", 
      "price": 237500, 
      "img": "../assets/products/10.jpg" 
    },
    { 
      "id": 11, 
      "name": "Giày Sneaker Nam Form Giày Cá Tính, Phối Màu Hiện Đại, Streetwear Chuẩn Chất", 
      "category": "Giày dép", 
      "price": 39500, 
      "img": "../assets/products/11.jpg" 
    },
    { 
      "id": 12, 
      "name": "Dép Sục Nam Quai Liền Khối Bản Rộng Phối Khoá Kim Loại", 
      "category": "Giày dép", 
      "price": 34500, 
      "img": "../assets/products/12.jpg" 
    },
    { 
      "id": 13, 
      "name": "Áo dệt kim tay dài nam. Loose", 
      "category": "Trang phục Thu Đông", 
      "price": 687000, 
      "img": "../assets/products/13.webp",
      "sizes": ["S","M","L","XL"], 
      "description": [
        "Áo len cổ tròn đỏ - lựa chọn lý tưởng cho nam giới yêu thích phong cách tối giản nhưng nổi bật. Màu đỏ rực rỡ kết hợp cùng phụ kiện tối màu giúp tôn lên sự tự tin và cá tính.",
        "Chất liệu: Len cao cấp, mềm mịn, giữ ấm tốt",
        "Màu sắc: Đỏ đô",
        "Kiểu dáng: Cổ tròn, tay dài, form regular"
      ],
      "images": [
        "../assets/products/13.webp",
        "../assets/products/13.1.webp",
        "../assets/products/13.2.webp",
        "../assets/products/13.3.webp"
      ]
    },
    { 
      "id": 14, 
      "name": "Áo gile phao nam đen", 
      "category": "Trang phục Thu Đông", 
      "price": 999000, 
      "img": "../assets/products/14.webp" 
    },
    { 
      "id": 15, 
      "name": "Bộ nỉ basic unisex", 
      "category": "Trang phục Thu Đông", 
      "price": 765000, 
      "img": "../assets/products/15.webp" 
    },
    { 
      "id": 16, 
      "name": "Áo len dệt kim nữ trắng viền đen", 
      "category": "Trang phục Thu Đông", 
      "price": 455000, 
      "img": "../assets/products/16.webp" 
    },
    { 
      "id": 17, 
      "name": "Áo ôm cổ cao nữ màu xám nhạt", 
      "category": "Trang phục Thu Đông", 
      "price": 473000, 
      "img": "../assets/products/17.webp" 
    },
    { 
      "id": 18, 
      "name": "Áo len nữ đen viền trắng basic", 
      "category": "Trang phục Thu Đông", 
      "price": 788000, 
      "img": "../assets/products/18.webp" 
    },
    { 
      "id": 19, 
      "name": "Mặt dây chuyền Bán Nguyệt Ánh Lam", 
      "category": "Phụ kiện", 
      "price": 3910000, 
      "img": "../assets/products/19.png",
      "sizes": ["30","31","32","33"], 
      "description": [
        "Lấy cảm hứng từ ánh trăng dịu dàng, Mặt dây chuyền Bán Nguyệt Ánh Lam được chế tác từ bạc cao cấp với phần mặt trăng ánh lam óng ánh. Thiết kế đơn giản mà tinh tế, tượng trưng cho sự nữ tính và bí ẩn.",
        "Chất liệu: Bạc 925 phủ bóng.",
        "Màu sắc: Ánh bạc kết hợp lam nhẹ.",
        "Kiểu dáng: Hình bán nguyệt.",
        "Phù hợp với: Vòng tay, dây chuyền hoặc charm mix nhiều kiểu."
      ],
      "images": [
        "../assets/products/19.png",
        "../assets/products/19.1.png",
        "../assets/products/19.2.png",
        "../assets/products/19.3.png"
      ]
    },
    { 
      "id": 20, 
      "name": "Ba lô thời trang unisex MWC hai tông xám", 
      "category": "Phụ kiện", 
      "price": 622000, 
      "img": "../assets/products/20.jpg" 
    },
    { 
      "id": 21, 
      "name": "Scrunchie ren hoa vintage nơ đỏ", 
      "category": "Phụ kiện", 
      "price": 177000, 
      "img": "../assets/products/21.jpeg" 
    },
    { 
      "id": 22, 
      "name": "Bịt tai lông siêu mềm Moji trắng sữa", 
      "category": "Phụ kiện", 
      "price": 245000, 
      "img": "../assets/products/22.jpeg" 
    },
    { 
      "id": 23, 
      "name": "Găng tay len hồng nơ xanh dễ thương", 
      "category": "Phụ kiện", 
      "price": 215000, 
      "img": "../assets/products/23.jpeg" 
    },
    { 
      "id": 24, 
      "name": "Mũ tai thỏ lông mềm nơ trắng", 
      "category": "Phụ kiện", 
      "price": 399000, 
      "img": "../assets/products/24.jpeg" 
    }
  ]
  </script>
  
  <!-- Scripts -->
  <script src="../js/checkout.js"></script>
  <script src="../js/auth-ui.js"></script>

  <script>
    (function () {
    // Hiện tên user / đăng xuất như các trang khác
    const acc = document.getElementById("accEntry");
    let u = null; try { u = JSON.parse(localStorage.getItem("currentUser") || "null"); } catch {}
    if (u && acc) {
    const initial = (u.name || "U").trim().charAt(0).toUpperCase();
    acc.outerHTML = `
        <div class="actions account-login acc-wrap" id="accWrap">
        <span class="avatar with-initial">${initial}</span>
        <span class="account-text">${u.name || "User"}</span>
        </div>`;
    }

    // Link Giỏ hàng → nếu chưa đăng nhập thì đưa sang login
    const cartLink = document.querySelector('.main-nav a[href$="cart.html"]');
    if (cartLink && !u) cartLink.href = './login.html?next=cart.html';

    // Đặt trạng thái active cho mục đang mở
    const file = location.pathname.split("/").pop();
    document.querySelectorAll(".main-nav > a").forEach(a => {
        const href = a.getAttribute("href");
        if (href && file === href.split("/").pop()) a.classList.add("active");
    });
    })();
  </script>

</body>
</html>
